#!/bin/bash

if [ $# -eq 0 ]; then
  echo './rails-new APP_PATH [options]' >&2
  exit 1
fi

app_path="$1"
shift

if [ -e "$app_path" ]; then
  echo "$app_path already exists" >&2
  exit 2
fi

mkdir "$app_path"
absolute_path="$(cd "$app_path" >/dev/null 2>&1 && pwd)"
rmdir "$app_path"
if [ -z "$absolute_path" ]; then
  echo "cannot get absoulte app_path" >&2
  exit 3
fi

cd "$(dirname $0)"
echo $ \
bundle exec rails new "$absolute_path" -m template.rb --skip-bundle -T "$@"
bundle exec rails new "$absolute_path" -m template.rb --skip-bundle -T "$@"
